<!DOCTYPE html>
<html>
  <head>
    <title>ASCII Art Jump and Run</title>
    <style>
      body {
        font-family: monospace;
        white-space: pre;
        font-size: 16px;
      }
      #gameCanvas {
        line-height: 1;
      }
    </style>
  </head>
  <body>
    <div id="gameCanvas"></div>
    <script>
      const canvasWidth = 120;
      const canvasHeight = 20;
      const groundLevel = canvasHeight - 2;
      let playerX = 10;
      let playerY = groundLevel;
      let isJumping = false;
      let jumpHeight = 2; // Reduced jump height
      let jumpCounter = 0;
      let gravity = 0.5; // Reduced gravity
      let yVelocity = 0;
      const keysPressed = {};

      const platforms = [
        { x: 15, y: groundLevel - 4, width: 10 },
        { x: 50, y: groundLevel - 6, width: 15 },
        { x: 80, y: groundLevel - 8, width: 20 },
      ];

      // Create the initial canvas
      const canvas = Array.from({ length: canvasHeight }, () =>
        Array(canvasWidth).fill(" ")
      );
      const gameCanvas = document.getElementById("gameCanvas");

      // Function to draw a tree
      function drawTree(x, y) {
        const tree = ["  ^  ", " ^^^ ", "^^^^^", "  |  ", "  |  "];
        for (let i = 0; i < tree.length; i++) {
          for (let j = 0; j < tree[i].length; j++) {
            if (x + j < canvasWidth && y + i < canvasHeight) {
              canvas[y + i][x + j] = tree[i][j];
            }
          }
        }
      }

      // Function to draw a cloud
      function drawCloud(x, y) {
        const cloud = ["  ___  ", " (   ) ", "(     )", " (___) "];
        for (let i = 0; i < cloud.length; i++) {
          for (let j = 0; j < cloud[i].length; j++) {
            if (x + j < canvasWidth && y + i < canvasHeight) {
              canvas[y + i][x + j] = cloud[i][j];
            }
          }
        }
      }

      // Function to draw platforms
      function drawPlatforms() {
        for (const platform of platforms) {
          for (let x = platform.x; x < platform.x + platform.width; x++) {
            if (x < canvasWidth && platform.y < canvasHeight) {
              canvas[platform.y][x] = "=";
            }
          }
        }
      }

      // Function to render the canvas
      function renderCanvas() {
        // Fill background with empty spaces
        for (let y = 0; y < canvasHeight; y++) {
          for (let x = 0; x < canvasWidth; x++) {
            canvas[y][x] = " ";
          }
        }

        // Draw the ground
        for (let x = 0; x < canvasWidth; x++) {
          canvas[groundLevel + 1][x] = "=";
        }

        // Draw trees
        drawTree(5, groundLevel - 4);
        drawTree(30, groundLevel - 4);
        drawTree(55, groundLevel - 4);
        drawTree(80, groundLevel - 4);

        // Draw clouds
        drawCloud(20, 3);
        drawCloud(50, 5);
        drawCloud(80, 2);

        // Draw platforms
        drawPlatforms();

        // Draw the player
        canvas[playerY][playerX] = "@";

        gameCanvas.textContent = canvas.map((row) => row.join("")).join("\n");
      }

      // Handle keyboard input
      document.addEventListener("keydown", (e) => {
        keysPressed[e.key] = true;
      });

      document.addEventListener("keyup", (e) => {
        keysPressed[e.key] = false;
      });

      // Check if the player is touching a platform
      function onPlatform() {
        for (const platform of platforms) {
          if (
            playerX >= platform.x &&
            playerX < platform.x + platform.width &&
            playerY + 1 === platform.y
          ) {
            return true;
          }
        }
        return false;
      }

      // Game loop
      function gameLoop() {
        if (keysPressed["ArrowRight"]) {
          playerX = Math.min(canvasWidth - 1, playerX + 1);
        } else if (keysPressed["ArrowLeft"]) {
          playerX = Math.max(0, playerX - 1);
        }

        if (keysPressed[" "] && !isJumping) {
          isJumping = true;
          yVelocity = -jumpHeight;
        }

        if (isJumping) {
          playerY += yVelocity;

          // Apply gravity
          yVelocity += gravity;

          // Check for landing on ground or platform
          if (playerY >= groundLevel) {
            playerY = groundLevel;
            isJumping = false;
          } else if (onPlatform()) {
            playerY =
              platforms.find(
                (platform) =>
                  playerX >= platform.x && playerX < platform.x + platform.width
              ).y - 1;
            isJumping = false;
          }
        } else if (playerY < groundLevel) {
          if (onPlatform()) {
            playerY =
              platforms.find(
                (platform) =>
                  playerX >= platform.x && playerX < platform.x + platform.width
              ).y - 1;
          } else {
            playerY = Math.min(groundLevel, playerY + gravity);
          }
        }

        renderCanvas();
      }

      setInterval(gameLoop, 1000 / 30);
    </script>
  </body>
</html>
